# 编码规则

此功能用于对编码规则进行设置，包括编码规则定义和编码映射两部分。对某种类型单据，在编码时需要对属性进行规定和规范。

## 编码规则定义

点击管理中心主界面上的【编码规则定义】，进入编码规则界面，如下图所示：

![](/articles/application/2-/images/image17.png)  
 
左侧是编码对象，选中一个对象，点击【新增】，新增一个编码规则，如下图所示：

![](/articles/application/2-/images/image18.png)  
 
规则编码、规则名称、编码实体和编码方式为必输项。在编码方式中，前编码是指新增时生成的编码，后编码是指保存时生成的编码。

1、	如果编码方式选择前编码，段类型包括常量、系统时间、流水号和随机号。选择系统时间时，“是否流水依据”可以选择非流水依据、按年流水、按月流水和按日流水。举例来说，如果今年是2016年，选择按年流水，则从2017年重新开始流水。

2、	如果如果编码方式选择后编码，段类型包括常量、字段值、系统时间、流水号和随机号。

“段类型”表示编码的组成类型，“段值”是编码的值，“段长度”是编码的最大长度，“日期格式”可以选择不同的日期格式，“补位方式”表示是否需要对编码进行补位，“补位符号”可以选择补位的符号，通过设置“是否流水依据”字段，可以使该编码规则按照某元素值的不同重新进行流水。

【是否断码补码】，用于定义如果删除一个单据，或者申请一个单据出错后，那么它们所使用的单据号是否要再被使用。如果勾选，则断码可再次被使用。

【编码是否可编辑】，用于控制编码的可编辑性。如果勾选，则可以对生成的编码进行编辑。

将鼠标放到每行的【操作】处，出现三个按钮，分别表示增行、删行和排序。
完成设置后，点击【保存】保存编码规则。

返回编码规则主界面，在【请输入搜索内容】中，输入规则编码或名称，搜索建好的编码规则。
对于已经生成的编码规则，可以进行设置，如下图：

![](/articles/application/2-/images/image19.png)  
 
四个按钮分别是编辑、删除、分配和更多操作，更多操作包括流水号管理、断号查询和设为默认。
对于分配操作，建立了编码规则，即可以进行分配，例如把规则分配给某些组织。

对于“流水号管理”操作，同一编码规则，因为设置了流水依据，会根据流水依据的不同值的组合生成多套流水号；可以在【流水号管理】中根据每套流水号根据流水依据产生的唯一标识查看相应的最大流水号，可以手工修改最大流水号，修改后产生的流水号以当前修改的值作为基准继续流水。

![](/articles/application/2-/images/image20.png)  
 
在“最大流水号”处输入值后，鼠标放到【操作】处，点击 ![](/articles/application/2-/images/image21.png)  ，出现的对号是保存，叉号是删除。

“断号查询”可以查询断号。“设为默认”是有多个编码规则时，将当前编码规则设置为默认的规则，设置后，可以点击【取消默认】取消设置。
按【返回】返回管理中心主界面。

## 编码映射

编码映射针对后编码中的字段值，从业务数据获取相关信息。编码映射为每一个可用于编码规则的业务实体的值进行重新映射。在生成编码规则时，按照映射后的值，作为编码的组成部分。

点击管理中心主界面上的【编码映射】，进入编码映射界面，如下图所示。鼠标放到每行的操作处，出现编辑和删除按钮。

![](/articles/application/2-/images/image22.png)  
 
点击新增，进入编码映射新增界面，如下图所示：

![](/articles/application/2-/images/image23.png)  
 
选择编码实体，设置映射值长度，设置编码、名称和映射值。鼠标放到每行的操作处，出现增行和删行按钮。点击【保存】保存当前编码规则映射。

返回编码映射主界面，点击【请输入编码】，输入编码对象名称，可进行搜索。

完成设置后，按【返回】返回管理中心主界面。
